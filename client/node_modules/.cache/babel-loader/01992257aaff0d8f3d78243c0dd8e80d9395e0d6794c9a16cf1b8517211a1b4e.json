{"ast":null,"code":"import{useContext,useEffect,useState}from'react';import{AuthContext}from'../utils/AuthContext';import{getBooks,borrowBook}from'../utils/api';import BookCard from'../components/BookCard';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Borrow=()=>{const{user}=useContext(AuthContext);const[books,setBooks]=useState([]);const[error,setError]=useState(null);useEffect(()=>{const fetchBooks=async()=>{try{const data=await getBooks();const availableBooks=data.filter(book=>book.available_copies>0);setBooks(availableBooks);}catch(err){console.error('Error fetching books:',err);setError('Failed to load books.');}};fetchBooks();},[]);const handleBorrow=async bookId=>{await borrowBook(bookId,user.token);setBooks(prevBooks=>prevBooks.filter(book=>book.id!==bookId));};if(error){return/*#__PURE__*/_jsx(\"div\",{style:{color:'red',padding:'20px'},children:error});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Borrow Books\"}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",style:{marginBottom:'20px'},children:/*#__PURE__*/_jsxs(\"select\",{style:{padding:'10px',borderRadius:'5px',border:'1px solid #d1d5db'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Filter by Availability\"}),/*#__PURE__*/_jsx(\"option\",{value:\"high\",children:\"High Availability (>1)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"low\",children:\"Low Availability (1)\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"grid\",children:books.map(book=>/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(BookCard,{book:book}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleBorrow(book.id),className:\"btn btn-primary\",style:{marginTop:'1rem'},children:\"Borrow\"})]},book.id))})]});};export default Borrow;","map":{"version":3,"names":["useContext","useEffect","useState","AuthContext","getBooks","borrowBook","BookCard","jsx","_jsx","jsxs","_jsxs","Borrow","user","books","setBooks","error","setError","fetchBooks","data","availableBooks","filter","book","available_copies","err","console","handleBorrow","bookId","token","prevBooks","id","style","color","padding","children","className","marginBottom","borderRadius","border","value","map","onClick","marginTop"],"sources":["/home/yusufmim/Library-Management-System/Library-Management-System/client/src/pages/Borrow.js"],"sourcesContent":["import { useContext, useEffect, useState } from 'react';\nimport { AuthContext } from '../utils/AuthContext';\nimport { getBooks, borrowBook } from '../utils/api';\nimport BookCard from '../components/BookCard';\n\nconst Borrow = () => {\n  const { user } = useContext(AuthContext);\n  const [books, setBooks] = useState([]);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    const fetchBooks = async () => {\n      try {\n        const data = await getBooks();\n        const availableBooks = data.filter(book => book.available_copies > 0);\n        setBooks(availableBooks);\n      } catch (err) {\n        console.error('Error fetching books:', err);\n        setError('Failed to load books.');\n      }\n    };\n\n    fetchBooks();\n  }, []);\n\n  const handleBorrow = async (bookId) => {\n    await borrowBook(bookId, user.token);\n    setBooks(prevBooks => prevBooks.filter(book => book.id !== bookId));\n  };\n\n  if (error) {\n    return <div style={{ color: 'red', padding: '20px' }}>{error}</div>;\n  }\n\n  return (\n    <div>\n      <h1>Borrow Books</h1>\n\n      <div className=\"form-group\" style={{ marginBottom: '20px' }}>\n        <select\n          style={{\n            padding: '10px',\n            borderRadius: '5px',\n            border: '1px solid #d1d5db'\n          }}\n        >\n          <option value=\"\">Filter by Availability</option>\n          <option value=\"high\">High Availability (&gt;1)</option>\n          <option value=\"low\">Low Availability (1)</option>\n        </select>\n      </div>\n\n      <div className=\"grid\">\n        {books.map(book => (\n          <div key={book.id} className=\"card\">\n            <BookCard book={book} />\n            <button\n              onClick={() => handleBorrow(book.id)}\n              className=\"btn btn-primary\"\n              style={{ marginTop: '1rem' }}\n            >\n              Borrow\n            </button>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default Borrow;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}